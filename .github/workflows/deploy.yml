name: Deploy Shopify Theme

on:
  push:
    branches:
      - main

jobs:
  deploy:
    runs-on: ubuntu-latest
    timeout-minutes: 30

    steps:
      - name: Checkout code
        uses: actions/checkout@v2

      - name: Set up Node.js
        uses: actions/setup-node@v2
        with:
          node-version: '20'

      - name: Install Shopify CLI
        run: npm install -g @shopify/cli @shopify/theme

      - name: Configure Shopify CLI Authentication
        env:
          SHOPIFY_STORE: your-store.myshopify.com  # Replace with your store URL
          SHOPIFY_PASSWORD: ${{ secrets.SHOPIFY_ACCESS_TOKEN }}
        run: |
          mkdir -p ~/.shopify-cli
          SHOPIFY_STORE=${{ env.SHOPIFY_STORE }}" > ~/.shopify-cli/.env
          SHOPIFY_PASSWORD=${{ secrets.SHOPIFY_ACCESS_TOKEN }}" >> ~/.shopify-cli/.env

      - name: Deploy to Shopify
        run: shopify theme push --store https://8b47fd-7d.myshopify.com --allow-live
        env:
          SHOPIFY_ACCESS_TOKEN: ${{ secrets.SHOPIFY_ACCESS_TOKEN }}
